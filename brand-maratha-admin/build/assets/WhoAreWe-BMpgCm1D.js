import{j as e,a,C as ae}from"./index-f6D6TMGS.js";import{a as y}from"./axios.config-D8NC-S8h.js";import{U as le,V as re,W as ie,X as ne,Y as oe,Z as ce,$ as de,a0 as me}from"./api.endpoints-D7eIfK11.js";import{M as ue}from"./Modal-Byr5KNe-.js";import{b as U}from"./index.esm-B7prAHhm.js";import{C as O,a as n}from"./CRow-C5aZ3uce.js";import{C as X,a as Y}from"./CCardBody-DyHbCEEC.js";import{C as v}from"./CCardHeader-BkEnHaV2.js";import{C as he,a as xe,b as M,c as D,d as pe,e as E}from"./CTable-Bj0B-88c.js";import{C as j}from"./CButton-ByJ5g7iZ.js";import{c as je}from"./cil-pen-53d2I-C-.js";import{c as be}from"./cil-trash-CBbKHhHb.js";import{c as fe,b as q,F as z}from"./formik.esm-DzZc3OM4.js";import{h as W}from"./errorHelper-EbapN-iz.js";import{C as Ce}from"./CFormSelect-BM6fWH_8.js";import{C as B}from"./CForm-BElthXFv.js";import{C as F,a as S}from"./CFormControlWrapper-aXjT4m4y.js";import{C as H}from"./CFormInput-CzlD-ECf.js";import{C as V}from"./CFormTextarea-3GaLNVd-.js";import{C as P}from"./CAlert-Ceafrkex.js";import"./CModalHeader-fVen3JA5.js";import"./DefaultLayout-BE9qYLzL.js";import"./cil-user-Ddrdy7PS.js";import"./CModalTitle-AQ6XSAyd.js";const ge=({whoarewe:r,formData:A,handleDelete:d,setActiveForm:w,setShowForm:x})=>{const m=s=>{A(s),w(!0),x(!0)};return e.jsx(O,{children:e.jsx(n,{xs:12,children:e.jsxs(X,{className:"mb-4",children:[e.jsxs(v,{children:[e.jsx("strong",{children:"Who are we"})," ",e.jsx("small",{children:"List"})]}),e.jsx(Y,{children:(r==null?void 0:r.length)>0?e.jsxs(he,{hover:!0,children:[e.jsx(xe,{children:e.jsxs(M,{children:[e.jsx(D,{scope:"col",children:"Title"}),e.jsx(D,{scope:"col",children:"Description"}),e.jsx(D,{scope:"col",children:"Action"})]})}),e.jsx(pe,{children:r==null?void 0:r.map((s,p)=>e.jsx(a.Fragment,{children:e.jsxs(M,{children:[e.jsx(E,{children:s==null?void 0:s.title}),e.jsx(E,{children:s==null?void 0:s.subtitle}),e.jsxs(E,{width:150,children:[e.jsx(j,{type:"button",color:"success",onClick:()=>m(s),children:e.jsx(U,{icon:je,size:"md"})}),e.jsx(j,{style:{marginLeft:"10px"},type:"button",color:"danger",onClick:()=>d(s==null?void 0:s.id),children:e.jsx(U,{icon:be,size:"md"})})]})]})},p))})]}):e.jsx(v,{children:e.jsx("strong",{children:"No who are we found!"})})})]})})})},Pe=()=>{const[r,A]=a.useState([]),[d,w]=a.useState("english"),[x,m]=a.useState(""),[s,p]=a.useState(!1),[T,N]=a.useState(!1),R=a.useRef(!0),[o,Z]=a.useState(null),[G,_]=a.useState(!1),[J,k]=a.useState(null),[f,K]=a.useState({}),[C,c]=a.useState(""),[Q,u]=a.useState(!1),$=fe().shape({title:q().required("Title is required").test("no-whitespace","Title cannot be empty or only spaces",t=>t&&t.trim().length>0).max(255,"Title must be at most 255 characters"),subtitle:q().required("Description is required").test("no-whitespace","Description cannot be empty or only spaces",t=>t&&t.trim().length>0).max(255,"Description must be at most 255 characters")});a.useEffect(()=>{Z({getWhoAreWe:d==="english"?de:me,postWhoAreWe:d==="english"?oe:ce,putWhoAreWe:d==="english"?ie:ne,deleteWhoAreWe:d==="english"?le:re})},[d]),a.useEffect(()=>{if(R.current){R.current=!1;return}o&&g(o)},[o]),a.useEffect(()=>{if(x||C){const t=setTimeout(()=>{m(""),c("")},3e3);return()=>clearTimeout(t)}},[x,C]);const g=async t=>{u(!0),c("");try{const l=await y.get(t.getWhoAreWe);A(l==null?void 0:l.data)}catch(l){c(W(l))}finally{u(!1)}};async function ee(t,{resetForm:l}){u(!0),c(""),m("");const h={...t,title:t.title.trim(),subtitle:t.subtitle.trim()};try{await y.post(o.postWhoAreWe,h),m("Record added successfully!"),g(o),l(),p(!1)}catch(i){c(W(i))}finally{u(!1)}}const te=t=>{k(t),_(!0)};async function se(){u(!0),c("");try{await y.delete(`${o.deleteWhoAreWe}/${J}`),g(o),N(!1)}catch(t){c(W(t))}finally{_(!1),k(null),u(!1)}}async function I(t,{resetForm:l}){if(u(!0),m(""),c(""),f.id===null){m("Please select a banner first.");return}const h={...t,title:t.title.trim(),subtitle:t.subtitle.trim()};try{await y.put(`${o.putWhoAreWe}/${f.id}`,h),m("Who are we updated successfully!"),g(o),p(!1),l()}catch(i){c(W(i))}finally{u(!1)}}const L=()=>{p(!s),N(!1)};return Q?e.jsx(ae,{color:"primary",className:"d-block mx-auto my-5"}):e.jsx(e.Fragment,{children:e.jsxs(O,{children:[e.jsxs(n,{xs:12,children:[e.jsxs(X,{className:"mb-4",children:[e.jsxs(v,{children:[e.jsxs("strong",{children:[" ",T?"Update":"Add"]})," ",e.jsx("small",{children:"who are we"})]}),e.jsxs(Y,{className:"row g-3",children:[e.jsx(n,{xs:12,md:4,lg:2,children:e.jsxs(Ce,{"aria-label":"Default select example",value:d,onChange:t=>w(t.target.value),disabled:s,children:[e.jsx("option",{value:"english",children:"English"}),e.jsx("option",{value:"marathi",children:"मराठी"})]})}),e.jsx(n,{xs:12,md:6,children:!(r!=null&&r.length)>0?e.jsx(j,{as:"input",type:"button",color:"primary",value:s!==!0?"Add":"Close",onClick:()=>L()}):!T||s&&e.jsx(j,{as:"input",type:"button",color:"primary",value:"Close",onClick:()=>L()})}),s?T?e.jsx(z,{initialValues:{title:f.title||"",subtitle:f.subtitle||""},enableReinitialize:!0,validationSchema:$,onSubmit:I,children:({values:t,handleChange:l,handleSubmit:h,errors:i,touched:b})=>e.jsxs(B,{className:"row g-3",onSubmit:h,children:[e.jsxs(n,{md:12,children:[e.jsxs(F,{htmlFor:"title",children:["Title",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(H,{type:"text",name:"title",value:t.title,onChange:l}),i.title&&b.title&&e.jsx(S,{className:"text-danger small",children:i.title})]}),e.jsxs(n,{md:12,children:[e.jsxs(F,{htmlFor:"subtitle",children:["Description",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(V,{type:"text",name:"subtitle",value:t.subtitle,onChange:l}),i.subtitle&&b.subtitle&&e.jsx(S,{className:"text-danger small",children:i.subtitle})]}),e.jsx(n,{md:12,children:e.jsx(j,{color:"primary",type:"submit",children:"Update"})})]})}):!(r!=null&&r.length)>0&&e.jsx(z,{initialValues:{title:"",subtitle:""},enableReinitialize:!0,validationSchema:$,onSubmit:ee,children:({values:t,handleChange:l,handleSubmit:h,errors:i,touched:b})=>e.jsxs(B,{className:"row g-3",onSubmit:h,children:[e.jsxs(n,{md:12,children:[e.jsxs(F,{htmlFor:"title",children:["Title",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(H,{type:"text",name:"title",value:t.title,onChange:l}),i.title&&b.title&&e.jsx(S,{className:"text-danger small",children:i.title})]}),e.jsxs(n,{md:12,children:[e.jsxs(F,{htmlFor:"subtitle",children:["Description",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(V,{type:"text",name:"subtitle",value:t.subtitle,onChange:l}),i.subtitle&&b.subtitle&&e.jsx(S,{className:"text-danger small",children:i.subtitle})]}),e.jsx(n,{md:12,children:e.jsx(j,{color:"primary",type:"submit",children:"Submit"})})]})}):null]})]}),e.jsxs("div",{className:"mt-4",children:[x&&e.jsx(P,{color:"primary",children:x}),C&&e.jsx(P,{color:"danger",children:C})]}),e.jsx(ge,{whoarewe:r,formData:K,handleDelete:te,handleUpdate:I,setActiveForm:N,setShowForm:p})]}),e.jsx(ue,{visible:G,onClose:()=>_(!1),onConfirm:se,title:"Confirm Delete",message:"Are you sure you want to delete this who are we?"})]})})};export{Pe as default};
