import{j as e,a as i,C as re}from"./index-f6D6TMGS.js";import{a as _}from"./axios.config-D8NC-S8h.js";import{ah as oe,ai as ce,aj as de,ak as xe,al as ue,am as me,an as he,ao as pe,b as je}from"./api.endpoints-D7eIfK11.js";import{M as ge}from"./Modal-Byr5KNe-.js";import{b as H}from"./index.esm-B7prAHhm.js";import{C as W,a as r}from"./CRow-C5aZ3uce.js";import{C as X,a as Y}from"./CCardBody-DyHbCEEC.js";import{C as k}from"./CCardHeader-BkEnHaV2.js";import{C as fe,a as be,b as V,c as f,d as Ce,e as C}from"./CTable-Bj0B-88c.js";import{C as T}from"./CButton-ByJ5g7iZ.js";import{c as ye}from"./cil-pen-53d2I-C-.js";import{c as _e}from"./cil-trash-CBbKHhHb.js";import{c as Fe,b as ve,d as Te,F as G}from"./formik.esm-DzZc3OM4.js";import{h as F}from"./errorHelper-EbapN-iz.js";import{C as v}from"./CFormSelect-BM6fWH_8.js";import{C as J}from"./CForm-BElthXFv.js";import{C as o,a as c}from"./CFormControlWrapper-aXjT4m4y.js";import{C as y}from"./CFormInput-CzlD-ECf.js";import{C as K}from"./CFormTextarea-3GaLNVd-.js";import{C as Q}from"./CAlert-Ceafrkex.js";import"./CModalHeader-fVen3JA5.js";import"./DefaultLayout-BE9qYLzL.js";import"./cil-user-Ddrdy7PS.js";import"./CModalTitle-AQ6XSAyd.js";const Ne=({item:p,formData:R,handleDelete:N,setActiveForm:I,setShowForm:j})=>{const A=s=>{R(s),I(!0),j(!0)};return e.jsx(W,{children:e.jsx(r,{xs:12,children:e.jsxs(X,{className:"mb-4",children:[e.jsxs(k,{children:[e.jsx("strong",{children:"Testimonials"})," ",e.jsx("small",{children:"list"})]}),e.jsx(Y,{children:(p==null?void 0:p.length)>0?e.jsxs(fe,{hover:!0,children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(f,{scope:"col",children:"Index"}),e.jsx(f,{scope:"col",children:"Rating"}),e.jsx(f,{scope:"col",width:90,children:"Title"}),e.jsx(f,{scope:"col",children:"Description"}),e.jsx(f,{scope:"col",v:!0,children:"User"}),e.jsx(f,{scope:"col",width:90,children:"Product"}),e.jsx(f,{scope:"col",width:120,children:"Action"})]})}),e.jsx(Ce,{children:p==null?void 0:p.map((s,u)=>e.jsx(i.Fragment,{children:e.jsxs(V,{children:[e.jsx(f,{scope:"row",children:u+1}),e.jsx(C,{children:s==null?void 0:s.rating}),e.jsx(C,{width:120,children:s!=null&&s.title?s==null?void 0:s.title:"-"}),e.jsx(C,{children:s!=null&&s.description?s==null?void 0:s.description:"-"}),e.jsx(C,{width:90,children:s!=null&&s.user?s==null?void 0:s.user:"-"}),e.jsx(C,{width:90,children:s!=null&&s.product_name?s==null?void 0:s.product_name:"-"}),e.jsxs(C,{width:120,children:[e.jsx(T,{type:"button",color:"success",onClick:()=>A(s),children:e.jsx(H,{icon:ye,size:"md"})}),e.jsx(T,{style:{marginLeft:"10px"},type:"button",color:"danger",onClick:()=>N(s==null?void 0:s.id),children:e.jsx(H,{icon:_e,size:"md"})})]})]})},u))})]}):e.jsx(k,{children:e.jsx("strong",{children:"No testimonials found!"})})})]})})})},Xe=()=>{const[p,R]=i.useState([]),[N,I]=i.useState([]),[j,A]=i.useState("english"),[s,u]=i.useState(""),[S,w]=i.useState(!1),[L,P]=i.useState(!1),[D,d]=i.useState(""),[Z,x]=i.useState(!1),[m,ee]=i.useState(null),[se,U]=i.useState(!1),[te,M]=i.useState(null),[g,O]=i.useState({}),q=i.useRef(!0),z=Fe().shape({rating:Te().typeError("Rating must be a number").required("Rating is required").min(1,"Rating must be at least 1").max(5,"Rating cannot be more than 5"),product_id:ve().required("Product ID is required").matches(/^\d+$/,"Product ID must be a number")});i.useEffect(()=>{ee({getTestimonialss:j==="english"?he:pe,postTestimonials:j==="english"?ue:me,putTestimonials:j==="english"?de:xe,deleteTestimonials:j==="english"?oe:ce})},[j]),i.useEffect(()=>{if(q.current){q.current=!1;return}m&&E(m)},[m]),i.useEffect(()=>{if(s||D){const t=setTimeout(()=>{u(""),d("")},3e3);return()=>clearTimeout(t)}},[s,D]),i.useEffect(()=>{(async()=>{x(!0),d("");try{const{data:t}=await _.get(je);I(t.data)}catch(t){d(F(t))}finally{x(!1)}})()},[]);const E=async t=>{x(!0),d("");try{const{data:n}=await _.get(t.getTestimonialss);R(n)}catch(n){d(F(n))}finally{x(!1)}};async function ae(t,{resetForm:n}){x(!0),u(""),d("");const b={...t,title:t.title.trim(),description:t.description.trim()},a=Object.fromEntries(Object.entries(b).filter(([l,h])=>h!==""));try{await _.post(m.postTestimonials,a),u("Testimonials created successfully!"),E(m),n(),w(!1)}catch(l){d(F(l))}finally{x(!1)}}const ne=t=>{M(t),U(!0)};async function ie(){x(!0),d("");try{await _.delete(`${m.deleteTestimonials}/${te}`),E(m),P(!1)}catch(t){d(F(t))}finally{U(!1),M(null),x(!1)}}async function B(t,{resetForm:n}){if(x(!0),u(""),d(""),g.id===null){u("Please select a banner first.");return}const b={...t,title:t.title.trim(),description:t.description.trim()},a=Object.fromEntries(Object.entries(b).filter(([l,h])=>h!==""));try{await _.put(`${m.putTestimonials}/${g.id}`,a),u("Testimonials updated successfully!"),E(m),O({}),n(),w(!1)}catch(l){d(F(l))}finally{x(!1)}}const le=()=>{w(!S),P(!1)};return Z?e.jsx(re,{color:"primary",className:"d-block mx-auto my-5"}):e.jsx(e.Fragment,{children:e.jsxs(W,{children:[e.jsxs(r,{xs:12,children:[e.jsxs(X,{className:"mb-4",children:[e.jsxs(k,{children:[e.jsxs("strong",{children:[" ",L?"Update":"Add"]})," ",e.jsx("small",{children:"testimonials"})]}),e.jsxs(Y,{className:"row g-3",children:[e.jsx(r,{xs:12,md:4,lg:2,children:e.jsxs(v,{"aria-label":"Default select example",value:j,onChange:t=>A(t.target.value),disabled:S,children:[e.jsx("option",{value:"english",children:"English"}),e.jsx("option",{value:"marathi",children:"मराठी"})]})}),e.jsx(r,{xs:12,md:6,children:e.jsx(T,{as:"input",type:"button",color:"primary",value:S!==!0?"Add":"Close",onClick:()=>le()})}),S?L?e.jsx(G,{initialValues:{rating:g.rating||"",title:g.title||"",description:g.description||"",user:g.user||"",location:g.location||"",product_id:g.product_id||""},enableReinitialize:!0,validationSchema:z,onSubmit:B,children:({values:t,handleChange:n,handleSubmit:b,errors:a,touched:l})=>e.jsxs(J,{className:"row g-3",onSubmit:b,children:[e.jsxs(r,{md:6,children:[e.jsxs(o,{htmlFor:"rating",children:["Rating",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(v,{"aria-label":"Default select example",name:"rating",value:t.rating,onChange:n,children:[e.jsx("option",{value:"",children:"Choose"}),e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5"})]}),a.rating&&l.rating&&e.jsx(c,{className:"text-danger small",children:a.rating})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"title",children:"Title"}),e.jsx(y,{type:"text",name:"title",value:t.title,onChange:n}),a.title&&l.title&&e.jsx(c,{className:"text-danger small",children:a.title})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"user",children:"User"}),e.jsx(y,{type:"text",name:"user",value:t.user,onChange:n}),a.user&&l.user&&e.jsx(c,{className:"text-danger small",children:a.user})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"user",children:"Location"}),e.jsx(y,{type:"text",name:"location",value:t.location,onChange:n}),a.location&&l.location&&e.jsx(c,{className:"text-danger small",children:a.location})]}),e.jsxs(r,{md:6,children:[e.jsxs(o,{htmlFor:"product_id",children:["Product",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(v,{"aria-label":"Default select example",name:"product_id",value:t.product_id,onChange:n,children:[e.jsx("option",{value:"",children:"Choose"}),N.map((h,$)=>e.jsx(i.Fragment,{children:e.jsx("option",{value:h.id,children:h.name})},$))]}),a.product_id&&l.product_id&&e.jsx(c,{className:"text-danger small",children:a.product_id})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(K,{type:"text",name:"description",value:t.description,onChange:n}),a.description&&l.description&&e.jsx(c,{className:"text-danger small",children:a.description})]}),e.jsx(r,{xs:12,children:e.jsx(T,{color:"primary",type:"submit",children:"Update"})})]})}):e.jsx(G,{initialValues:{rating:"",title:"",description:"",user:"",location:"",product_id:""},enableReinitialize:!0,validationSchema:z,onSubmit:ae,children:({values:t,handleChange:n,handleSubmit:b,errors:a,touched:l})=>e.jsxs(J,{className:"row g-3 needs-validation",onSubmit:b,children:[e.jsxs(r,{md:6,children:[e.jsxs(o,{htmlFor:"rating",children:["Rating",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(v,{"aria-label":"Default select example",name:"rating",value:t.rating,onChange:n,children:[e.jsx("option",{value:"",children:"Choose"}),e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5"})]}),a.rating&&l.rating&&e.jsx(c,{className:"text-danger small",children:a.rating})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"title",children:"Title"}),e.jsx(y,{type:"text",name:"title",value:t.title,onChange:n}),a.title&&l.title&&e.jsx(c,{className:"text-danger small",children:a.title})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"user",children:"User"}),e.jsx(y,{type:"text",name:"user",value:t.user,onChange:n}),a.user&&l.user&&e.jsx(c,{className:"text-danger small",children:a.user})]}),e.jsxs(r,{md:6,children:[e.jsx(o,{htmlFor:"user",children:"Location"}),e.jsx(y,{type:"text",name:"location",value:t.location,onChange:n}),a.location&&l.location&&e.jsx(c,{className:"text-danger small",children:a.location})]}),e.jsxs(r,{md:6,children:[e.jsxs(o,{htmlFor:"product_id",children:["Product",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(v,{"aria-label":"Default select example",name:"product_id",value:t.product_id,onChange:n,children:[e.jsx("option",{value:"",children:"Choose"}),N.map((h,$)=>e.jsx(i.Fragment,{children:e.jsx("option",{value:h.id,children:h.name})},$))]}),a.product_id&&l.product_id&&e.jsx(c,{className:"text-danger small",children:a.product_id})]}),e.jsxs(r,{md:12,children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(K,{type:"text",name:"description",value:t.description,onChange:n}),a.description&&l.description&&e.jsx(c,{className:"text-danger small",children:a.description})]}),e.jsx(r,{xs:12,children:e.jsx(T,{color:"primary",type:"submit",children:"Submit"})})]})}):null]})]}),e.jsxs("div",{className:"mt-4",children:[s&&e.jsx(Q,{color:"primary",children:s}),D&&e.jsx(Q,{color:"danger",children:D})]}),e.jsx(Ne,{item:p,formData:O,handleDelete:ne,handleUpdate:B,setActiveForm:P,s:!0,setShowForm:w})]}),e.jsx(ge,{visible:se,onClose:()=>U(!1),onConfirm:ie,title:"Confirm Delete",message:"Are you sure you want to delete this testimonisls?"})]})})};export{Xe as default};
