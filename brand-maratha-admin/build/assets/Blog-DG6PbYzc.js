import{m as w,u as S,j as e,a as o,C as T}from"./index-f6D6TMGS.js";import{C as k,a as v}from"./CRow-C5aZ3uce.js";import{C as z,a as _}from"./CCardBody-DyHbCEEC.js";import{C as g}from"./CCardHeader-BkEnHaV2.js";import{C as f}from"./CButton-ByJ5g7iZ.js";import{C as B,a as L,b as C,c as n,d as D,e as h}from"./CTable-Bj0B-88c.js";import{a as j}from"./axios.config-D8NC-S8h.js";import{e as E,au as N,av as R,aw as $}from"./api.endpoints-D7eIfK11.js";import{h as A}from"./errorHelper-EbapN-iz.js";import{C as M}from"./CAlert-Ceafrkex.js";import"./index.esm-B7prAHhm.js";import"./DefaultLayout-BE9qYLzL.js";import"./cil-user-Ddrdy7PS.js";const F=({blogs:r,magazineBlogIds:i,handleToggleMagazine:d})=>{const l=w(),{pathname:t}=S();return e.jsx(k,{children:e.jsx(v,{xs:12,children:e.jsxs(z,{className:"mb-4",children:[e.jsxs(g,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Blogs"})," ",e.jsx("small",{children:"list"})]}),e.jsx(f,{color:"primary",onClick:()=>l(t==="/brand-details"?"/brand-details/add":"/base/blog/add"),children:"ADD BLOG"})]}),e.jsx(_,{children:(r==null?void 0:r.length)>0?e.jsxs(B,{hover:!0,children:[e.jsx(L,{children:e.jsxs(C,{children:[e.jsx(n,{scope:"col",children:"Index"}),e.jsx(n,{scope:"col",children:"Title"}),e.jsx(n,{scope:"col",children:"Label"}),e.jsx(n,{scope:"col",children:"Auther"}),e.jsx(n,{scope:"col",children:"Date"}),e.jsx(n,{scope:"col",children:"Action"})]})}),e.jsx(D,{children:r==null?void 0:r.map((s,x)=>e.jsx(o.Fragment,{children:e.jsxs(C,{children:[e.jsx(n,{scope:"row",children:x+1}),e.jsx(h,{children:(s==null?void 0:s.title)||"-"}),e.jsx(h,{children:(s==null?void 0:s.label)||"-"}),e.jsx(h,{children:(s==null?void 0:s.author)||"-"}),e.jsx(h,{children:new Date(s.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})||"-"}),e.jsx(h,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid #ccc",borderRadius:"5px",padding:"7px 10px",gap:"6px"},children:[e.jsx("input",{type:"checkbox",checked:i==null?void 0:i.has(s.id),onChange:()=>d(s.id)}),e.jsx("span",{style:{fontSize:14,fontWeight:500},children:"Magazine"})]}),e.jsx(f,{type:"button",color:"success",size:"sm",style:{padding:"6px 10px"},onClick:()=>l(t==="/brand-details"?`/brand-details/${s.id}`:`/base/blog/${s.id}`),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"auto",fill:"none",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",style:{marginBottom:"2px"},children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})})]})},x))})]}):e.jsx(g,{children:e.jsx("strong",{children:"No blogs found!"})})})]})})})},Z=()=>{const[r,i]=o.useState([]),[d,l]=o.useState(new Set),[t,s]=o.useState(""),[x,m]=o.useState(!1);o.useEffect(()=>{if(t){const a=setTimeout(()=>s(""),3e3);return()=>clearTimeout(a)}},[t]),o.useEffect(()=>{y()},[]);const y=async()=>{m(!0),s("");try{const[a,c]=await Promise.all([j.get(E),j.get(N)]);i(a.data);const p=new Set(c.data.map(u=>u.blog_id||u.id));l(p)}catch(a){s(A(a))}finally{m(!1)}},b=async a=>{try{if(d.has(a))await j.delete(`${R}/${a}`),l(c=>{const p=new Set(c);return p.delete(a),p});else{if(d.size>=4){s("Only 4 blogs can be added to the magazine.");return}await j.post(`${$}/${a}`),l(c=>new Set(c).add(a))}}catch{s("Failed to update magazine state")}};return e.jsxs(e.Fragment,{children:[x&&e.jsx(T,{color:"primary",className:"d-block mx-auto my-5"}),t&&e.jsx(M,{color:"danger",className:"mx-3",children:t}),!x&&e.jsx(F,{blogs:r,magazineBlogIds:d,handleToggleMagazine:b})]})};export{Z as default};
