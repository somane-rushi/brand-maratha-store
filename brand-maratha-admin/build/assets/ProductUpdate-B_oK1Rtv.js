import{o as se,m as ie,a as m,j as e,C as te}from"./index-f6D6TMGS.js";import{c as ne,b as u,a as re,f as F,d as p,F as le}from"./formik.esm-DzZc3OM4.js";import{a as w}from"./axios.config-D8NC-S8h.js";import{bu as ce,bm as de,aN as oe,d as me,r as he,aT as ge}from"./api.endpoints-D7eIfK11.js";import{h as H}from"./errorHelper-EbapN-iz.js";import{M as z,T as k}from"./TagInput-D3Dx2LHQ.js";import{D as S,f as xe,c as je}from"./data-TWB-jpMp.js";import{C as $}from"./CAlert-Ceafrkex.js";import{C as f,a as y}from"./CCardBody-DyHbCEEC.js";import{C as N}from"./CCardHeader-BkEnHaV2.js";import{C as W}from"./CButton-ByJ5g7iZ.js";import{C as be}from"./CForm-BElthXFv.js";import{C as h,a as n}from"./CRow-C5aZ3uce.js";import{C as d}from"./CFormControlWrapper-aXjT4m4y.js";import{C as L}from"./CFormSelect-BM6fWH_8.js";import{C as j}from"./CFormInput-CzlD-ECf.js";import{C as T}from"./CFormTextarea-3GaLNVd-.js";import"./DefaultLayout-BE9qYLzL.js";import"./index.esm-B7prAHhm.js";import"./cil-user-Ddrdy7PS.js";const ve=()=>{const{id:v}=se(),U=ie(),[P,K]=m.useState({}),[a,Y]=m.useState({}),[M,J]=m.useState([]),[X,Z]=m.useState([]),[C,E]=m.useState(""),[Q,I]=m.useState(!1),[A,D]=m.useState({thumbnail:""}),V=ne().shape({catalogue_ids:F().of(p().required("Invalid catalogue")).min(1,"At least one catalogue must be selected").required("Catalogue is required"),category_id:p().required("Category is required"),subcategory_id:p().required("Subcategory is required"),name:u().required("Product name is required").test("no-whitespace","Cannot be only spaces",s=>s&&s.trim().length>0),slug:u().required("Slug is required").test("no-whitespace","Cannot be only spaces",s=>s&&s.trim().length>0),description:u().required("Description is required").test("no-whitespace","Cannot be only spaces",s=>s&&s.trim().length>0),return_policy:u().required("Return policy is required").test("no-whitespace","Cannot be only spaces",s=>s&&s.trim().length>0),subname:u().required("Subname is required").test("no-whitespace","Cannot be only spaces",s=>s&&s.trim().length>0),brand_id:u().required("Brand is required"),length:p().typeError("Length must be a number").required("Length is required"),breadth:p().typeError("Breadth must be a number").required("Breadth is required"),height:p().typeError("Height must be a number").required("Height is required"),weight:p().typeError("Weight must be a number").required("Weight is required"),collection_ids:F().of(p().required("Invalid collection")).optional().nullable(),thumbnail_image:re().nullable().test("fileType","Only JPG, JPEG, and PNG formats are allowed",s=>!s||typeof s=="string"?!0:s instanceof File&&["image/jpg","image/jpeg","image/png"].includes(s.type)).test("fileSize","File size must be less than 5MB",function(s){return!s||typeof s!="object"?!0:s.size>5*1024*1024?this.createError({message:"File exceeds 5MB limit"}):!0}),traditional_categories:u().required("Traditional category is required").test("not-empty","Traditional category cannot be empty or only spaces",s=>!!s&&s.trim().length>0)});m.useEffect(()=>{(async()=>{I(!0);try{const[s,o,r,R]=await Promise.all([w.get(ce),w.get(`${de}/${v}`),w.get(oe),w.get(me)]),{data:i}=s||[],{thumbnail_image:t}=o.data;t&&D({thumbnail:t}),K(i),Y(o.data),J(r.data),Z(R.data)}catch(s){E(H(s))}finally{I(!1)}})()},[]),m.useEffect(()=>{if(C){const s=setTimeout(()=>{E("")},3e3);return()=>clearTimeout(s)}},[C]);const ee=async(s,{resetForm:o})=>{I(!0),E("");try{const r=new FormData;Object.keys(s).forEach(i=>{const t=s[i],b=typeof t=="string",q=Array.isArray(t);t==null||q&&t.length===0||(q?t.forEach(g=>{(typeof g=="string"&&g.trim()!==""||typeof g=="number")&&r.append(`${i}[]`,typeof g=="string"?g.trim():g)}):r.append(i,b?t.trim():t))}),(await w.put(`${ge}/${v}`,r,{headers:{"Content-Type":"multipart/form-data"}})).status===200&&(o(),U("/products-list")),D({thumbnail:""})}catch(r){E(H(r))}finally{I(!1)}};return Q?e.jsx(te,{color:"primary",className:"d-block mx-auto my-5"}):C?e.jsx($,{color:"danger",children:C}):e.jsxs(f,{children:[e.jsxs(N,{className:"d-flex align-items-center gap-3",children:[e.jsxs(W,{color:"secondary",variant:"outline",className:"d-flex align-items-center gap-2",onClick:()=>U(-1),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Back"]}),e.jsx("strong",{className:"fs-5",children:"UPDATE PRODUCT LISTING"})]}),e.jsxs(y,{children:[e.jsx(le,{enableReinitialize:!0,initialValues:{catalogue_ids:(a==null?void 0:a.catalogue_ids)||[],category_id:a!=null&&a.category_id?Number(a.category_id):null,subcategory_id:a!=null&&a.subcategory_id?Number(a.subcategory_id):null,item_id:a!=null&&a.item_id?Number(a.item_id):null,name:(a==null?void 0:a.name)||"",slug:(a==null?void 0:a.slug)||"",description:(a==null?void 0:a.description)||"",return_policy:(a==null?void 0:a.return_policy)||"",subname:(a==null?void 0:a.subname)||"",brand_id:(a==null?void 0:a.brand_id)||"",collection_ids:(a==null?void 0:a.collection_ids)||[],images:Array.isArray(a==null?void 0:a.images)?a.images:[],thumbnail_image:(a==null?void 0:a.thumbnail_image)||null,video:(a==null?void 0:a.video)||null,fit:(a==null?void 0:a.fit)||"",length:(a==null?void 0:a.length)||"",breadth:(a==null?void 0:a.breadth)||"",height:(a==null?void 0:a.height)||"",weight:(a==null?void 0:a.weight)||"",fabric:(a==null?void 0:a.fabrics)||[],stretchable:(a==null?void 0:a.stretchable)||"",key_feature:(a==null?void 0:a.key_features)||[],in_the_box:(a==null?void 0:a.in_the_box)||"",search_keyword:(a==null?void 0:a.search_keyword)||"",size_chart:(a==null?void 0:a.size_chart)||null,care_guide:(a==null?void 0:a.care_guide)||"",pattern:(a==null?void 0:a.patterns)||[],print_type:(a==null?void 0:a.print_type)||"",country_origin:(a==null?void 0:a.country_origin)||"",manufacturing_details:(a==null?void 0:a.manufacturing_details)||"",traditional_categories:(a==null?void 0:a.traditional_categories)||""},validationSchema:V,onSubmit:ee,children:({values:s,setFieldValue:o,handleChange:r,handleSubmit:R,errors:i,touched:t})=>{var O;const[b,q]=m.useState([]),[g,B]=m.useState([]),[G,ae]=m.useState([]);return m.useEffect(()=>{const l=(Array.isArray(P)?P:[]).filter(c=>{var x;return(x=s.catalogue_ids)==null?void 0:x.includes(c.id)}),_=[...new Map(l.flatMap(c=>c.categories||[]).map(c=>[c.id,c])).values()];q(_)},[s.catalogue_ids]),m.useEffect(()=>{if(!s.category_id||!b.length)return;const l=b.find(c=>c.id===s.category_id),_=[...new Map(((l==null?void 0:l.subcategories)||[]).map(c=>[c.id,c])).values()];B(_)},[b,s.category_id]),m.useEffect(()=>{if(!s.category_id||!b.length)return;const l=b.find(c=>c.id===s.category_id),_=[...new Map(((l==null?void 0:l.subcategories)||[]).map(c=>[c.id,c])).values()];B(_)},[b,s.category_id]),m.useEffect(()=>{if(!s.subcategory_id||!g.length)return;const l=g.find(x=>x.id===s.subcategory_id),c=((l==null?void 0:l.items)||[]).map(x=>typeof x=="object"?x:{id:x,name:String(x)});ae(c),s.item_id&&!c.find(x=>x.id===s.item_id)&&o("item_id",null)},[g,s.subcategory_id]),e.jsxs(be,{onSubmit:R,className:"mt-3",children:[e.jsxs(f,{children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT IDENTITY"})}),e.jsxs(y,{className:"d-flex flex-column row-gap-2",children:[e.jsxs(h,{children:[e.jsx(n,{md:4,children:e.jsx(z,{label:"Select Catalogue",name:"catalogue_ids",placeholder:"Select Catalogue",options:P,values:s.catalogue_ids,setFieldValue:o,error:i.catalogue_ids,touched:t.catalogue_ids})}),e.jsx(n,{md:4,children:e.jsx(S,{label:"Category",name:"category_id",placeholder:"fit...",options:b,value:s.category_id,setFieldValue:o,error:i.category_id,touched:t.category_id,disabled:b.length===0||!((O=s.catalogue_ids)!=null&&O.length)})}),e.jsx(n,{md:4,children:e.jsx(S,{label:"Sub Category",name:"subcategory_id",placeholder:"fit...",options:g,value:s.subcategory_id,setFieldValue:o,error:i.subcategory_id,touched:t.subcategory_id,disabled:g.length===0||!s.category_id})})]}),e.jsxs(h,{children:[e.jsx(n,{md:4,children:e.jsx(S,{label:"Item",name:"item_id",placeholder:"fit...",options:G,value:s.item_id,setFieldValue:o,error:i.item_id,touched:t.item_id,disabled:G.length===0||!s.subcategory_id})}),e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["BRAND",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(L,{name:"brand_id",value:s.brand_id,onChange:r,children:[e.jsx("option",{value:"",children:"Select Brand"}),Array.isArray(M)&&M.length>0?M.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id)):e.jsx("option",{disabled:!0,children:"No brands available"})]}),i.brand_id&&t.brand_id&&e.jsx("div",{className:"text-danger smalls",children:i.brand_id})]})]})]})]}),e.jsxs(f,{className:"mt-4",children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT IMAGES"})}),e.jsx(y,{className:"d-flex flex-column row-gap-4",children:e.jsx(h,{children:e.jsxs(n,{md:4,children:[e.jsxs(d,{className:"fw-semibold",children:["THUMBNAIL IMAGE",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Test",type:"file",name:"thumbnail_image",onChange:l=>{const _=l.target.files[0];_&&(o("thumbnail_image",_),D(c=>({...c,thumbnail:URL.createObjectURL(_)})))}}),i.thumbnail_image&&t.thumbnail_image&&e.jsx("div",{className:"text-danger smalls",children:i.thumbnail_image}),A.thumbnail&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:A.thumbnail.startsWith("blob:")?A.thumbnail:he+A.thumbnail,alt:"Preview",width:100,style:{borderRadius:"5px"}})})]})})})]}),e.jsxs(f,{className:"mt-4",children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT SPECIFICATION"})}),e.jsxs(y,{className:"d-flex flex-column row-gap-4",children:[e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["NAME",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Product Name",type:"text",name:"name",value:s.name,onChange:r}),i.name&&t.name&&e.jsx("div",{className:"text-danger smalls",children:i.name})]}),e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["SUBNAME",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Sub Name",type:"text",name:"subname",value:s.subname,onChange:r}),i.subname&&t.subname&&e.jsx("div",{className:"text-danger smalls",children:i.subname})]})]}),e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["SLUG",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Product Slug",type:"text",name:"slug",value:s.slug,onChange:r}),i.slug&&t.slug&&e.jsx("div",{className:"text-danger smalls",children:i.slug})]}),e.jsx(n,{md:3,children:e.jsx(S,{label:"Size fit",name:"fit",placeholder:"fit...",options:xe,value:s.fit,setFieldValue:o,error:i.fit,touched:t.fit})}),e.jsx(n,{xs:3,children:e.jsx(k,{label:"Fabric",placeholder:"Type to search...",name:"fabric",values:s.fabric,setFieldValue:o,error:i.fabric,touched:t.fabric})})]}),e.jsxs(h,{children:[e.jsx(n,{xs:6,children:e.jsx(k,{label:"Pattern",placeholder:"Type to search...",name:"pattern",values:s.pattern,setFieldValue:o,error:i.pattern,touched:t.pattern})}),e.jsxs(n,{md:6,children:[e.jsx(d,{htmlFor:"print_type",className:"fw-semibold",children:"PRINT TYPE"}),e.jsx(j,{placeholder:"Print Type",type:"text",name:"print_type",value:s.print_type,onChange:r}),i.print_type&&t.print_type&&e.jsx("div",{className:"text-danger small",children:i.print_type})]})]}),e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsx(d,{htmlFor:"stretchable",className:"fw-semibold",children:"STRETCHABLE"}),e.jsxs(L,{name:"stretchable",value:s.stretchable,onChange:r,children:[e.jsx("option",{value:"",children:"Select Stretchable"}),e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]}),i.stretchable&&t.stretchable&&e.jsx("div",{className:"text-danger small",children:i.stretchable})]}),e.jsx(n,{xs:6,children:e.jsx(k,{label:"Key Features",placeholder:"Type to search...",name:"key_feature",values:s.key_feature,setFieldValue:o,error:i.key_feature,touched:t.key_feature})})]}),e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{htmlFor:"size_chart",className:"fw-semibold",children:["SIZE CHART",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{type:"file",name:"size_chart",onChange:l=>o("size_chart",l.target.files[0])}),i.size_chart&&t.size_chart&&e.jsx("div",{className:"text-danger small",children:i.size_chart})]}),e.jsxs(n,{md:6,children:[e.jsx(d,{htmlFor:"in_the_box",className:"fw-semibold",children:"IN THE BOX"}),e.jsx(j,{placeholder:"In the box",type:"text",name:"in_the_box",value:s.in_the_box,onChange:r}),i.in_the_box&&t.in_the_box&&e.jsx("div",{className:"text-danger small",children:i.in_the_box})]})]}),e.jsxs(h,{children:[e.jsxs(n,{xs:6,children:[e.jsxs(d,{htmlFor:"search_keyword",className:"fw-semibold",children:["SEARCH KEYWORDS",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{placeholder:"Search Keyword",type:"text",name:"search_keyword",value:s.search_keyword,onChange:r}),i.search_keyword&&t.search_keyword&&e.jsx("div",{className:"text-danger small",children:i.search_keyword})]}),e.jsxs(n,{md:6,children:[e.jsx(d,{htmlFor:"care_guide",className:"fw-semibold",children:"CARE GUIDE"}),e.jsx(T,{placeholder:"Care Guide",type:"text",name:"care_guide",value:s.care_guide,onChange:r}),i.care_guide&&t.care_guide&&e.jsx("div",{className:"text-danger small",children:i.care_guide})]})]}),e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["DESCRIPTION",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{placeholder:"Description",type:"text",name:"description",value:s.description,onChange:r}),i.description&&t.description&&e.jsx("div",{className:"text-danger smalls",children:i.description})]}),e.jsxs(n,{md:6,children:[e.jsxs(d,{className:"fw-semibold",children:["RETURN POLICY",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{placeholder:"Policy",type:"text",name:"return_policy",value:s.return_policy,onChange:r}),i.return_policy&&t.return_policy&&e.jsx("div",{className:"text-danger smalls",children:i.return_policy})]})]})]})]}),e.jsxs(f,{className:"mt-4",children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"PACKAGE DETAILS"})}),e.jsxs(y,{className:"d-flex flex-column row-gap-4",children:[e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{htmlFor:"length",className:"fw-semibold",children:["LENGTH (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Length",type:"number",name:"length",value:s.length,onChange:r}),i.length&&t.length&&e.jsx("div",{className:"text-danger small",children:i.length})]}),e.jsxs(n,{md:6,children:[e.jsxs(d,{htmlFor:"breadth",className:"fw-semibold",children:["BREADTH (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Breadth",type:"number",name:"breadth",value:s.breadth,onChange:r}),i.breadth&&t.breadth&&e.jsx("div",{className:"text-danger small",children:i.breadth})]})]}),e.jsxs(h,{children:[e.jsxs(n,{md:6,children:[e.jsxs(d,{htmlFor:"height",className:"fw-semibold",children:["HEIGHT (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Height",type:"number",name:"height",value:s.height,onChange:r}),i.height&&t.height&&e.jsx("div",{className:"text-danger small",children:i.height})]}),e.jsxs(n,{md:6,children:[e.jsxs(d,{htmlFor:"weight",className:"fw-semibold",children:["WEIGHT (KG)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(j,{placeholder:"Weight",name:"weight",type:"number",value:s.weight,onChange:r}),i.weight&&t.weight&&e.jsx("div",{className:"text-danger small",children:i.weight})]})]})]})]}),e.jsxs(f,{className:"mt-4",children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"MANUFACTURING DETAILS"})}),e.jsx(y,{children:e.jsxs(h,{children:[e.jsx(n,{md:6,children:e.jsx(S,{label:"Country of Origin",name:"country_origin",placeholder:"country...",options:je,value:s.country_origin,setFieldValue:o,error:i.country_origin,touched:t.country_origin})}),e.jsxs(n,{md:6,children:[e.jsx(d,{htmlFor:"manufacturing_details",className:"fw-semibold",children:"MANUFACTURER DETAILS"}),e.jsx(T,{placeholder:"Manufacturer Details",type:"text",name:"manufacturing_details",value:s.manufacturing_details,onChange:r})]})]})})]}),e.jsxs(f,{className:"mt-4",children:[e.jsx(N,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT INTEGRATION"})}),e.jsx(y,{children:e.jsxs(h,{children:[e.jsx(n,{md:4,children:e.jsx(z,{label:"Select Collection",name:"collection_ids",placeholder:"Select Collection",options:X||[],values:s.collection_ids,setFieldValue:o,error:i.collection_ids,touched:t.collection_ids})}),e.jsxs(n,{xs:6,children:[e.jsxs(d,{htmlFor:"traditional_categories",className:"fw-semibold",children:["TRADITIONAL CATEGORIES",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(L,{name:"traditional_categories",value:s.traditional_categories,onChange:r,children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"tam",children:"Traditional Marathi (TAM)"}),e.jsx("option",{value:"lam",children:"Look a like Marathi (LAM)"}),e.jsx("option",{value:"rim",children:"Re-Imagined Marathi (RIM)"})]}),i.traditional_categories&&t.traditional_categories&&e.jsx("div",{className:"text-danger small",children:i.traditional_categories})]})]})})]}),e.jsx(W,{color:"success",type:"submit",className:"mt-3",children:"Update"})]})}}),C&&e.jsx($,{children:C})]})]})};export{ve as default};
