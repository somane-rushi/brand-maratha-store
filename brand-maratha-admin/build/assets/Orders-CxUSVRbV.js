import{m as W,a as r,j as e,C as q}from"./index-f6D6TMGS.js";import{a as G,bw as J,bx as K}from"./api.endpoints-D7eIfK11.js";import{a as g}from"./axios.config-D8NC-S8h.js";import{M as Q}from"./Modal-Byr5KNe-.js";import{b as V}from"./index.esm-B7prAHhm.js";import{h as y}from"./errorHelper-EbapN-iz.js";import{C as X,a as Y}from"./CRow-C5aZ3uce.js";import{C as Z,a as ee}from"./CCardBody-DyHbCEEC.js";import{C as I}from"./CCardHeader-BkEnHaV2.js";import{C as se,a as re,b as U,c as l,d as ae,e as t}from"./CTable-Bj0B-88c.js";import{o as oe}from"./DefaultLayout-BE9qYLzL.js";import{C as h}from"./CButton-ByJ5g7iZ.js";import{c as le}from"./cil-trash-CBbKHhHb.js";import{C as te,a as S}from"./CPaginationItem-BqJRYRTb.js";import{C as ne,a as ce,b as de}from"./CModalHeader-fVen3JA5.js";import{C as ie,a as ue}from"./CModalTitle-AQ6XSAyd.js";import{C as he}from"./CFormSelect-BM6fWH_8.js";import"./cil-user-Ddrdy7PS.js";import"./CFormControlWrapper-aXjT4m4y.js";const De=()=>{const B=W(),[w,N]=r.useState([]),[E,m]=r.useState(!1),[c,n]=r.useState(""),[a,x]=r.useState(1),[b,A]=r.useState(null),[v,M]=r.useState(""),[$,d]=r.useState(!1),[k,O]=r.useState(!1),[F,p]=r.useState(!1),[H,P]=r.useState(null),C=10;r.useEffect(()=>{if(c){const s=setTimeout(()=>{n("")},3e3);return()=>clearTimeout(s)}},[c]),r.useEffect(()=>{j()},[]);const j=async()=>{m(!0),n("");try{const{data:s}=await g.get(G);N(s)}catch(s){n(y(s))}finally{m(!1)}},R=s=>{A(s),M(s.status),d(!0)},z=async()=>{if(b){O(!0),n("");try{await g.put(`${K}/${b.id}/status`,{status:v}),d(!1),j()}catch(s){n(y(s))}finally{O(!1)}}},T=async(s=null,o=!1)=>{if(!o){P(s),p(!0);return}try{await g.delete(`${J}/${H}`)}catch(u){n(y(u))}finally{p(!1),P(null),j()}},f=Math.ceil(w.length/C),i=w.slice((a-1)*C,a*C);return E?e.jsx(q,{color:"primary"}):c?e.jsx(CAlert,{color:"danger",children:c}):e.jsxs(X,{children:[e.jsx(Y,{xs:12,children:e.jsxs(Z,{className:"mb-4",children:[e.jsx(I,{className:"d-flex justify-content-between align-items-center",children:e.jsxs("div",{children:[e.jsx("strong",{children:"Orders"})," ",e.jsx("small",{children:"List"})]})}),e.jsx(ee,{children:(i==null?void 0:i.length)>0?e.jsxs(e.Fragment,{children:[e.jsxs(se,{hover:!0,children:[e.jsx(re,{children:e.jsxs(U,{children:[e.jsx(l,{scope:"col",children:"Customer"}),e.jsx(l,{scope:"col",children:"Order Id"}),e.jsx(l,{scope:"col",children:"Price"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Courier"}),e.jsx(l,{scope:"col",children:"Order Date"}),e.jsx(l,{scope:"col",children:"Action"})]})}),e.jsx(ae,{children:i.map((s,o)=>{var u,_,L,D;return e.jsx(r.Fragment,{children:e.jsxs(U,{children:[e.jsx(t,{children:s==null?void 0:s.user_id}),e.jsx(t,{children:s==null?void 0:s.id}),e.jsx(t,{children:s==null?void 0:s.total_price}),e.jsx(t,{onClick:()=>R(s),style:{cursor:"pointer"},children:e.jsx(oe,{color:((u=s==null?void 0:s.status)==null?void 0:u.toLowerCase())==="pending"?"warning":((_=s==null?void 0:s.status)==null?void 0:_.toLowerCase())==="delivered"?"success":((L=s==null?void 0:s.status)==null?void 0:L.toLowerCase())==="cancelled"?"danger":"secondary",children:(D=s==null?void 0:s.status)==null?void 0:D.toUpperCase()})}),e.jsx(t,{children:s==null?void 0:s.courier}),e.jsx(t,{children:new Date(s==null?void 0:s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsxs(t,{className:"d-flex gap-2",children:[e.jsx(h,{color:"warning",onClick:()=>B(`/order-details/${s.id}`),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"auto",fill:"none",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",style:{marginBottom:"3px"},children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),e.jsx(h,{color:"danger",onClick:()=>T(s.id),children:e.jsx(V,{icon:le})})]})]})},o)})})]}),e.jsx(Q,{visible:F,onClose:()=>p(!1),onConfirm:()=>T(null,!0),title:"Confirm Delete",message:"Are you sure you want to delete this order?"}),e.jsxs(te,{align:"end",className:"mt-3",children:[e.jsx(S,{disabled:a===1,onClick:()=>x(a-1),style:{cursor:a===1?"default":"pointer"},children:"Previous"}),Array.from({length:f},(s,o)=>e.jsx(S,{active:o+1===a,onClick:()=>x(o+1),style:{cursor:o+1===a?"default":"pointer"},children:o+1},o+1)),e.jsx(S,{disabled:a===f,onClick:()=>x(a+1),style:{cursor:a===f?"default":"pointer"},children:"Next"})]})]}):e.jsx(I,{children:e.jsx("strong",{children:"No orders found!"})})})]})}),e.jsxs(ne,{visible:$,onClose:()=>d(!1),children:[e.jsx(ce,{children:e.jsx(ie,{children:"Update Order Status"})}),e.jsx(de,{children:e.jsxs(he,{value:v,onChange:s=>M(s.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),e.jsxs(ue,{children:[e.jsx(h,{color:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(h,{color:"primary",onClick:z,disabled:k,children:k?"Updating...":"Update"})]})]})]})};export{De as default};
