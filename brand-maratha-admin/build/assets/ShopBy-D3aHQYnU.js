import{j as e,a as o,C as me}from"./index-f6D6TMGS.js";import{r as he,aN as Fe,aO as Te,aP as ve,aQ as qe,aR as Ie,b as Le,aS as Ee,aT as Me}from"./api.endpoints-D7eIfK11.js";import{a as A}from"./axios.config-D8NC-S8h.js";import{M as Ae}from"./Modal-Byr5KNe-.js";import{F as re,c as ue,a as xe,b as f}from"./formik.esm-DzZc3OM4.js";import{h as H}from"./errorHelper-EbapN-iz.js";import{I as le,a as oe}from"./ImagePreview-BEQ8m4jE.js";import{b as de}from"./index.esm-B7prAHhm.js";import{C as ae,a as p}from"./CRow-C5aZ3uce.js";import{C as ne,a as X}from"./CCardBody-DyHbCEEC.js";import{C as ee}from"./CCardHeader-BkEnHaV2.js";import{C as ge,a as je,b as se,c as y,d as fe,e as F}from"./CTable-Bj0B-88c.js";import{C as I}from"./CButton-ByJ5g7iZ.js";import{c as Be}from"./cil-pen-53d2I-C-.js";import{c as ze}from"./cil-trash-CBbKHhHb.js";import{C as _e}from"./CInputGroup-UwF181Kr.js";import{C as h}from"./CFormInput-CzlD-ECf.js";import{C as pe}from"./CForm-BElthXFv.js";import{C as u,a as x}from"./CFormControlWrapper-aXjT4m4y.js";import{C as V}from"./CAlert-Ceafrkex.js";import{C as Re}from"./CFormSelect-BM6fWH_8.js";import{C as $e,a as te}from"./CPaginationItem-BqJRYRTb.js";import"./CModalHeader-fVen3JA5.js";import"./DefaultLayout-BE9qYLzL.js";import"./cil-user-Ddrdy7PS.js";import"./CModalTitle-AQ6XSAyd.js";import"./index-C7_v8csn.js";const De=({item:t,formData:C,handleDelete:S,setActiveForm:B,setShowForm:z})=>{const O=r=>{C(r),B(!0),z(!0)};return e.jsx(ae,{children:e.jsx(p,{xs:12,children:e.jsxs(ne,{className:"mb-4",children:[e.jsxs(ee,{children:[e.jsx("strong",{children:"Brands"})," ",e.jsx("small",{children:"List"})]}),e.jsx(X,{children:(t==null?void 0:t.length)>0?e.jsx("div",{style:{width:"100%",overflowX:"auto"},children:e.jsx("div",{style:{minWidth:"1200px"},children:e.jsxs(ge,{hover:!0,responsive:"sm",className:"mb-0",children:[e.jsx(je,{children:e.jsxs(se,{children:[e.jsx(y,{scope:"col",children:"Sr. No."}),e.jsx(y,{scope:"col",children:"Title"}),e.jsx(y,{scope:"col",children:"E-Mail"}),e.jsx(y,{scope:"col",children:"Vender Code"}),e.jsx(y,{scope:"col",children:"GST No."}),e.jsx(y,{scope:"col",children:"CIN No."}),e.jsx(y,{scope:"col",children:"Contact No."}),e.jsx(y,{scope:"col",children:"Image"}),e.jsx(y,{scope:"col",children:"Action"})]})}),e.jsx(fe,{children:t.map((r,w)=>e.jsxs(se,{children:[e.jsx(y,{children:w+1}),e.jsx(F,{children:(r==null?void 0:r.name)||"-"}),e.jsx(F,{children:(r==null?void 0:r.contact_email)||"-"}),e.jsx(F,{children:(r==null?void 0:r.pickup_vendor_code)||"-"}),e.jsx(F,{children:(r==null?void 0:r.gst)||"-"}),e.jsx(F,{children:(r==null?void 0:r.cin)||"-"}),e.jsx(F,{children:(r==null?void 0:r.contact_phone)||"-"}),e.jsx(F,{children:e.jsx("img",{src:he+r.image,height:"40px",width:"auto",alt:"brand-image"})}),e.jsxs(F,{children:[e.jsx(I,{type:"button",color:"success",onClick:()=>O(r),children:e.jsx(de,{icon:Be,size:"md"})}),e.jsx(I,{style:{marginLeft:"10px"},type:"button",color:"danger",onClick:()=>S(r==null?void 0:r.id),children:e.jsx(de,{icon:ze,size:"md"})})]})]},w))})]})})}):e.jsx(ee,{children:e.jsx("strong",{children:"No Brand found!"})})})]})})})},Oe=ue().shape({name:f().required("Title is required").test("no-whitespace","Title cannot be empty or only spaces",t=>t&&t.trim().length>0).max(255,"Title must be at most 255 characters").test("word-count",function(t){if(!t)return this.createError({message:"Title is required"});const C=t.trim().split(/\s+/).length;return C>5?this.createError({message:`Title must not exceed 5 words. Currently, it has ${C}.`}):!0}).matches(/^[a-zA-Z0-9\s.,!?()-]+$/,"Title contains invalid characters"),remarks:f().optional(),pickup_address:f().required("Pickup address is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_city:f().required("Pickup city is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_state:f().required("Pickup state is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_pincode:f().required("Pickup pincode is required").matches(/^[0-9]{6}$/,"Pincode must be 6 digits"),contact_phone:f().required("Contact phone is required").matches(/^[0-9]{10}$/,"Phone must be 10 digits"),contact_email:f().required("Contact email is required").matches(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,"Invalid email format").email("Invalid email format"),image:xe().nullable().test("fileRequired","Image is required",function(t){const{existing_image:C}=this.parent;return!C&&!t?this.createError({message:"Image is required"}):!0}).test("fileType","Only JPG, PNG, and WebP files are allowed",t=>!t||typeof t!="object"?!0:["image/jpeg","image/png","image/webp"].includes(t.type)).test("fileSize","File size must be less than 5MB",function(t){return!t||typeof t!="object"?!0:t.size>5*1024*1024?this.createError({message:"File exceeds 5MB limit"}):!0})}),Ue=ue().shape({name:f().required("Title is required").test("no-whitespace","Title cannot be empty or only spaces",t=>t&&t.trim().length>0).max(255,"Title must be at most 255 characters").test("word-count",function(t){if(!t)return this.createError({message:"Title is required"});const C=t.trim().split(/\s+/).length;return C>5?this.createError({message:`Title must not exceed 5 words. Currently, it has ${C}.`}):!0}).matches(/^[a-zA-Z0-9\s.,!?()-]+$/,"Title contains invalid characters"),pickup_address:f().required("Pickup address is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_city:f().required("Pickup city is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_state:f().required("Pickup state is required").test("no-whitespace","Cannot be only spaces",t=>t&&t.trim().length>0),pickup_pincode:f().required("Pickup pincode is required").matches(/^[0-9]{6}$/,"Pincode must be 6 digits"),contact_phone:f().required("Contact phone is required").matches(/^[0-9]{10}$/,"Phone must be 10 digits"),contact_email:f().required("Contact email is required").matches(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,"Invalid email format").email("Invalid email format"),remarks:f().optional(),image:xe().nullable().test("fileType","Only JPG, PNG, and WebP files are allowed",t=>!t||typeof t!="object"?!0:["image/jpeg","image/png","image/webp"].includes(t.type)).test("fileSize","File size must be less than 5MB",function(t){return!t||typeof t!="object"?!0:t.size>12*1024*1024?this.createError({message:"File exceeds 12MB limit"}):!0})}),We=()=>{const[t,C]=o.useState([]),[S,B]=o.useState(""),[z,O]=o.useState([]),[r,w]=o.useState(""),[Z,T]=o.useState(!1),[U,L]=o.useState(!1),[v,W]=o.useState(null),[R,_]=o.useState(""),[$,b]=o.useState(!1),q=o.useRef(null),[J,Q]=o.useState(null),[Y,D]=o.useState(!1),[G,E]=o.useState(!1),[i,g]=o.useState(!1),[c,d]=o.useState({}),[j,N]=o.useState(null),[ke,ye]=o.useState("Confirm Deletion"),[Ce,we]=o.useState("Are you sure you want to delete this brands?");o.useEffect(()=>{K()},[]),o.useEffect(()=>{if(r||R){const s=setTimeout(()=>{w(""),_("")},3e3);return()=>clearTimeout(s)}},[r,R]),o.useEffect(()=>{N(c.image||"")},[c.image]),o.useEffect(()=>{if(!S.trim()){O(t);return}const s=S.toLowerCase(),k=t.filter(n=>{var l,a,m,P,M,ce;return((l=n.name)==null?void 0:l.toLowerCase().includes(s))||((a=n.contact_email)==null?void 0:a.toLowerCase().includes(s))||((m=n.pickup_vendor_code)==null?void 0:m.toLowerCase().includes(s))||((P=n.gst)==null?void 0:P.toLowerCase().includes(s))||((M=n.cin)==null?void 0:M.toLowerCase().includes(s))||((ce=n.contact_phone)==null?void 0:ce.toLowerCase().includes(s))});O(k)},[S,t]);const K=async()=>{b(!0);try{const{data:s}=await A.get(Fe);C(s)}catch(s){_(H(s))}finally{b(!1)}};async function be(s,{resetForm:k}){b(!0),w(""),_("");const n={name:s.name.trim(),remarks:s.remarks.trim(),pickup_address:s.pickup_address.trim(),pickup_city:s.pickup_city.trim(),pickup_state:s.pickup_state.trim(),pickup_pincode:s.pickup_pincode.trim(),contact_phone:s.contact_phone.trim(),contact_email:s.contact_email.trim(),gst:s.gst.trim(),cin:s.cin.trim()},l=new FormData;l.append("name",n.name),l.append("remarks",n.remarks),l.append("image",s.image),l.append("pickup_address",n.pickup_address||""),l.append("pickup_city",n.pickup_city||""),l.append("pickup_state",n.pickup_state||""),l.append("pickup_pincode",n.pickup_pincode||""),l.append("contact_phone",n.contact_phone||""),l.append("contact_email",n.contact_email||""),l.append("gst",n.gst||""),l.append("cin",n.cin||"");try{const{data:a}=await A.post(Te,l,{headers:{"Content-Type":"multipart/form-data"}});w(a==null?void 0:a.message),K(),q.current&&(q.current.value=""),T(!1),k()}catch(a){_(H(a))}finally{console.log("Form submission completed"),b(!1)}}async function ie(s,{resetForm:k}){_(""),w(""),b(!0);const n={name:s.name.trim(),remarks:s.remarks.trim(),pickup_address:s.pickup_address.trim(),pickup_city:s.pickup_city.trim(),pickup_state:s.pickup_state.trim(),pickup_pincode:s.pickup_pincode.trim(),contact_phone:s.contact_phone.trim(),contact_email:s.contact_email.trim(),gst:s.gst.trim(),cin:s.cin.trim()};if(c.id===null){w("Please select first banner.");return}const l=new FormData;l.append("name",n.name),l.append("remarks",n.remarks),l.append("pickup_address",n.pickup_address),l.append("pickup_city",n.pickup_city),l.append("pickup_state",n.pickup_state),l.append("pickup_pincode",n.pickup_pincode),l.append("contact_phone",n.contact_phone),l.append("contact_email",n.contact_email),l.append("gst",n.gst),l.append("cin",n.cin),l.append("image",s.image);try{await A.put(`${ve}/${c.id}`,l,{headers:{"Content-Type":"multipart/form-data"}}),w("Brand updated successfully!"),K(),q.current&&(q.current.value=""),k(),d({}),N(""),T(!1),g(!i)}catch(a){_(H(a))}finally{b(!1)}}const Ne=async s=>{try{const{data:k}=await A.get(`${qe}/${s}`),l=((k==null?void 0:k.data)||[]).length>0;ye(l?"Shift Products First":"Confirm Deletion"),we(l?"Please shift all products to another collection before deleting this one.":"Are you sure you want to delete this collection?"),W(l?null:s),L(!0)}catch(k){_(H(k))}};async function Se(){if(v===null){L(!1);return}b(!0),_("");try{await A.delete(`${Ie}/${v}`),K()}catch(s){_(H(s))}finally{L(!1),W(null),b(!1)}}const Pe=()=>{T(!Z),g(!1)};return $?e.jsx(me,{color:"primary",className:"d-block mx-auto my-5"}):e.jsx(e.Fragment,{children:e.jsxs(ae,{children:[e.jsxs(p,{xs:12,children:[e.jsxs(ne,{className:"mb-4",children:[e.jsx(ee,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[" ",i?"Update":"Add"]})," ",e.jsx("small",{children:"Brands"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(_e,{style:{maxWidth:"250px"},children:[e.jsx(h,{placeholder:"Search...",value:S,onChange:s=>B(s.target.value),"aria-label":"Search input"}),e.jsx(I,{color:"primary",onClick:()=>B(""),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:`M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 
                                .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 
                                2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z`})})})]}),e.jsx(I,{as:"input",type:"button",color:"primary",value:Z?"Close":"Add",onClick:Pe})]})]})}),Z?i?e.jsx(e.Fragment,{children:e.jsx(X,{className:"row g-3",children:e.jsx(re,{initialValues:{name:c.name||"",image:null,pickup_address:c.pickup_address||"",pickup_city:c.pickup_city||"",pickup_state:c.pickup_state||"",pickup_pincode:c.pickup_pincode||"",contact_phone:c.contact_phone||"",contact_email:c.contact_email||"",remarks:c.remarks||"",gst:c.gst||"",cin:c.cin||""},enableReinitialize:!0,validationSchema:Ue,onSubmit:ie,children:({values:s,setFieldValue:k,handleChange:n,handleSubmit:l,errors:a,touched:m})=>e.jsxs(pe,{className:"row g-3 needs-validation",onSubmit:l,children:[e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"name",children:["Brand",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"name",value:s.name,onChange:n}),a.name&&m.name&&e.jsx(x,{className:"text-danger smalls",children:a.name})]}),e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"contact_email",children:["Contact E-Mail",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"contact_email",value:s.contact_email,onChange:n}),a.contact_email&&m.contact_email&&e.jsx(x,{className:"text-danger smalls",children:a.contact_email})]}),e.jsxs(p,{md:6,children:[e.jsx(u,{htmlFor:"remarks",children:"Remarks"}),e.jsx(h,{type:"text",name:"remarks",value:s.remarks,onChange:n}),a.remarks&&m.remarks&&e.jsx(x,{className:"text-danger smalls",children:a.remarks})]}),e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"pickup_address",children:["Pickup Address",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_address",value:s.pickup_address,onChange:n}),a.pickup_address&&m.pickup_address&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_address})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_city",children:["Pickup City",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_city",value:s.pickup_city,onChange:n}),a.pickup_city&&m.pickup_city&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_city})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_state",children:["Pickup State",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_state",value:s.pickup_state,onChange:n}),a.pickup_state&&m.pickup_state&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_state})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_pincode",children:["Pickup Pincode",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_pincode",value:s.pickup_pincode,onChange:n}),a.pickup_pincode&&m.pickup_pincode&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_pincode})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"contact_phone",children:["Contact Phone",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"contact_phone",value:s.contact_phone,onChange:n}),a.contact_phone&&m.contact_phone&&e.jsx(x,{className:"text-danger smalls",children:a.contact_phone})]}),e.jsxs(p,{md:4,children:[e.jsx(u,{htmlFor:"gst",children:"GST No."}),e.jsx(h,{type:"text",name:"gst",value:s.gst,onChange:n}),a.gst&&m.gst&&e.jsx(x,{className:"text-danger smalls",children:a.gst})]}),e.jsxs(p,{md:4,children:[e.jsx(u,{htmlFor:"cin",children:"CIN No."}),e.jsx(h,{type:"text",name:"cin",value:s.cin,onChange:n}),a.cin&&m.cin&&e.jsx(x,{className:"text-danger smalls",children:a.cin})]}),e.jsxs(p,{md:8,children:[e.jsxs(u,{htmlFor:"image",children:["Image",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(h,{type:"file",accept:"image/*",name:"image",onChange:P=>{const M=P.target.files[0];M&&(Q(M),D(!0))},ref:q}),j&&e.jsx(I,{color:"primary",size:"md",type:"button",onClick:()=>E(!0),children:"Preview"})]}),e.jsxs("div",{children:[e.jsx(le,{show:Y,imageFile:J,onClose:()=>D(!1),onCropDone:P=>{k("image",P),N(URL.createObjectURL(P))}}),e.jsx(oe,{visible:G,imageFile:j!=null&&j.startsWith("blob:")?j:he+j,onClose:()=>E(!1)})]}),a.image&&m.image&&e.jsx(x,{className:"text-danger smalls",children:a.image})]}),e.jsx(p,{xs:12,children:e.jsx(I,{color:"primary",type:"submit",children:"Submit"})}),r&&e.jsx(V,{color:"primary mt-4",children:r})]})})})}):e.jsx(X,{className:"row g-3",children:e.jsx(re,{initialValues:{name:"",remarks:"",image:null,pickup_address:"",pickup_city:"",pickup_state:"",pickup_pincode:"",contact_phone:"",contact_email:"",gst:"",cin:""},validationSchema:Oe,onSubmit:be,children:({values:s,setFieldValue:k,handleChange:n,handleSubmit:l,errors:a,touched:m})=>e.jsxs(pe,{className:"row g-3 needs-validation",onSubmit:l,children:[e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"name",children:["Brand",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"name",value:s.name,onChange:n}),a.name&&m.name&&e.jsx(x,{className:"text-danger smalls",children:a.name})]}),e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"contact_email",children:["Contact E-Mail",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"contact_email",value:s.contact_email,onChange:n}),a.contact_email&&m.contact_email&&e.jsx(x,{className:"text-danger smalls",children:a.contact_email})]}),e.jsxs(p,{md:6,children:[e.jsx(u,{htmlFor:"remarks",children:"Remarks"}),e.jsx(h,{type:"text",name:"remarks",value:s.remarks,onChange:n}),a.remarks&&m.remarks&&e.jsx(x,{className:"text-danger smalls",children:a.remarks})]}),e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"pickup_address",children:["Pickup Address",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_address",value:s.pickup_address,onChange:n}),a.pickup_address&&m.pickup_address&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_address})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_city",children:["Pickup City",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_city",value:s.pickup_city,onChange:n}),a.pickup_city&&m.pickup_city&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_city})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_state",children:["Pickup State",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_state",value:s.pickup_state,onChange:n}),a.pickup_state&&m.pickup_state&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_state})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"pickup_pincode",children:["Pickup Pincode",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"pickup_pincode",value:s.pickup_pincode,onChange:n}),a.pickup_pincode&&m.pickup_pincode&&e.jsx(x,{className:"text-danger smalls",children:a.pickup_pincode})]}),e.jsxs(p,{md:4,children:[e.jsxs(u,{htmlFor:"contact_phone",children:["Contact Phone",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(h,{type:"text",name:"contact_phone",value:s.contact_phone,onChange:n}),a.contact_phone&&m.contact_phone&&e.jsx(x,{className:"text-danger smalls",children:a.contact_phone})]}),e.jsxs(p,{md:4,children:[e.jsx(u,{htmlFor:"gst",children:"GST No."}),e.jsx(h,{type:"text",name:"gst",value:s.gst,onChange:n}),a.gst&&m.gst&&e.jsx(x,{className:"text-danger smalls",children:a.gst})]}),e.jsxs(p,{md:4,children:[e.jsx(u,{htmlFor:"contact_phone",children:" CIN No."}),e.jsx(h,{type:"text",name:"cin",value:s.cin,onChange:n}),a.cin&&m.cin&&e.jsx(x,{className:"text-danger smalls",children:a.cin})]}),e.jsxs(p,{md:6,children:[e.jsxs(u,{htmlFor:"image",children:["Image",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(h,{type:"file",accept:"image/*",name:"image",onChange:P=>{const M=P.target.files[0];M&&(Q(M),D(!0))},ref:q}),s.image&&e.jsx(I,{color:"primary",size:"md",type:"button",onClick:()=>E(!0),children:"Preview"})]}),e.jsxs("div",{children:[e.jsx(le,{show:Y,imageFile:J,onClose:()=>D(!1),onCropDone:P=>{k("image",P)}}),e.jsx(oe,{visible:G,imageFile:s.image,onClose:()=>E(!1)})]}),a.image&&m.image&&e.jsx(x,{className:"text-danger smalls",children:a.image})]}),e.jsx(p,{xs:12,children:e.jsx(I,{color:"primary",type:"submit",children:"Submit"})}),r&&e.jsx(V,{color:"primary mt-4",children:r})]})})}):null]}),e.jsxs("div",{className:"mt-4",children:[r&&e.jsx(V,{color:"primary",children:r}),R&&e.jsx(V,{color:"danger",children:R})]}),e.jsx(De,{item:z,formData:d,handleDelete:Ne,handleUpdate:ie,setActiveForm:g,setShowForm:T})]}),e.jsx(Ae,{visible:U,onClose:()=>L(!1),onConfirm:Se,title:ke,message:Ce})]})})},fs=()=>{const[t,C]=o.useState(""),[S,B]=o.useState(""),[z,O]=o.useState([]),[r,w]=o.useState([]),[Z,T]=o.useState(!1),[U,L]=o.useState(""),[v,W]=o.useState(null),R=o.useRef({}),[_,$]=o.useState(1),b=10,q=[{id:2,name:"New Arrival"},{id:3,name:"Best Seller"}],J={2:"new_arrivals",3:"isbestseller"};o.useEffect(()=>{if(U){const i=setTimeout(()=>L(""),3e3);return()=>clearTimeout(i)}},[U]),o.useEffect(()=>{Q()},[t]),o.useEffect(()=>{if(!S.trim()){w(z);return}const i=S.toLowerCase(),g=z.filter(c=>{var d,j,N;return((d=c.name)==null?void 0:d.toLowerCase().includes(i))||((j=c.brand_name)==null?void 0:j.toLowerCase().includes(i))||((N=c.search_keyword)==null?void 0:N.toLowerCase().includes(i))});w(g),$(1)},[S,z]),o.useEffect(()=>{const i=g=>{var c;v!==null&&!((c=R.current[v])!=null&&c.contains(g.target))&&W(null)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[v]);const Q=async()=>{var i,g;T(!0);try{let c=[];!t||t==="All products"?c=(await A.get(Le)).data.data:c=(await A.get(Ee,{params:{filterType:t}})).data,O(c),w(c),$(1)}catch(c){L(((g=(i=c==null?void 0:c.response)==null?void 0:i.data)==null?void 0:g.message)||c.message||"Something went wrong")}finally{T(!1)}},Y=async(i,g)=>{var c,d;T(!0);try{await A.put(`${Me}/${i}`,g,{headers:{"Content-Type":"multipart/form-data"}}),await Q()}catch(j){L(((d=(c=j==null?void 0:j.response)==null?void 0:c.data)==null?void 0:d.message)||j.message||"Update failed")}finally{T(!1)}},D=(i,g)=>{const c=E.find(N=>N.id===i),d=J[g];if(!c||!d)return;const j=c[d]?0:1;Y(i,{[d]:j})},G=Math.ceil(r.length/b),E=r.slice((_-1)*b,_*b);return Z?e.jsx(me,{color:"primary",className:"d-block mx-auto my-5"}):U?e.jsx(V,{color:"danger",children:U}):e.jsx(ae,{children:e.jsxs(p,{xs:12,children:[e.jsxs(ne,{className:"mb-4",children:[e.jsxs(ee,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Product"})," ",e.jsx("small",{children:"List"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(_e,{style:{maxWidth:"250px"},children:[e.jsx(h,{placeholder:"Search...",value:S,onChange:i=>B(i.target.value),"aria-label":"Search input"}),e.jsx(I,{color:"primary",onClick:()=>B(""),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:`M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 
                                                .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 
                                                2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z`})})})]}),e.jsxs(Re,{value:t,style:{width:"150px"},onChange:i=>C(i.target.value),children:[e.jsx("option",{children:"All products"}),e.jsx("option",{value:"new_arrivals",children:"New Arrivals"}),e.jsx("option",{value:"best_sellers",children:"Best Sellers"})]})]})]}),e.jsx(X,{children:E.length>0?e.jsxs(ge,{hover:!0,children:[e.jsx(je,{children:e.jsxs(se,{children:[e.jsx(y,{scope:"col",children:"Sr. No."}),e.jsx(y,{children:"Name"}),e.jsx(y,{children:"Brand"}),e.jsx(y,{children:"Tags"})]})}),e.jsx(fe,{children:E.map((i,g)=>{const c=new Set([...i.new_arrivals?[2]:[],...i.isbestseller?[3]:[]]);return e.jsxs(se,{children:[e.jsx(y,{children:g+1}),e.jsx(F,{children:(i==null?void 0:i.name)||"-"}),e.jsx(F,{children:(i==null?void 0:i.brand_name)||"-"}),e.jsx(F,{children:e.jsxs("div",{ref:d=>R.current[i.id]=d,onClick:()=>W(v===i.id?null:i.id),style:{width:242,border:"1px solid #ccc",borderRadius:5,padding:"4px 8px",position:"relative",cursor:"pointer",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",gap:5},tabIndex:0,onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(W(v===i.id?null:i.id),d.preventDefault())},children:[e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:5,maxHeight:60,overflowY:"auto",flex:1},children:c.size===0?e.jsx("span",{style:{color:"#999"},children:"Select tags..."}):Array.from(c).map(d=>{const j=q.find(N=>N.id===d);return j&&e.jsxs("span",{style:{backgroundColor:"#007bff",color:"white",padding:"2px 8px",borderRadius:12,display:"flex",alignItems:"center",gap:6,fontSize:14,whiteSpace:"nowrap"},children:[j.name,e.jsx("span",{onClick:N=>{N.stopPropagation(),D(i.id,j.id)},style:{cursor:"pointer"},children:"×"})]},j.id)})}),e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",style:{marginLeft:"auto",flexShrink:0,marginTop:"5px"},children:e.jsx("polyline",{points:"6 9 12 15 18 9",fill:"none",stroke:"currentColor",strokeWidth:"2"})}),v===i.id&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,border:"1px solid #ccc",borderRadius:5,background:"#fff",zIndex:9999,padding:5,marginTop:2,maxHeight:150,overflowY:"auto"},onClick:d=>d.stopPropagation(),children:q.map(d=>e.jsxs("label",{style:{display:"block",padding:"4px 8px",backgroundColor:c.has(d.id)?"#e6f0ff":"#fff",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:c.has(d.id),onChange:()=>D(i.id,d.id),style:{marginRight:8}}),d.name]},d.id))})]})})]},i.id)})})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("strong",{children:"No products found!"})})})]}),e.jsxs($e,{align:"end",className:"mt-3",children:[e.jsx(te,{disabled:_===1,onClick:()=>$(i=>Math.max(i-1,1)),children:"Previous"}),Array.from({length:G},(i,g)=>e.jsx(te,{active:g+1===_,onClick:()=>$(g+1),children:g+1},g)),e.jsx(te,{disabled:_===G,onClick:()=>$(i=>Math.min(i+1,G)),children:"Next"})]}),e.jsx(We,{})]})})};export{fs as default};
