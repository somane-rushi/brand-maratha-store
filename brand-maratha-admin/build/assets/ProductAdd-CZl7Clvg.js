import{m as Q,a as m,j as e,C as V}from"./index-f6D6TMGS.js";import{c as ee,a as F,d as p,b as u,f as G,F as ae}from"./formik.esm-DzZc3OM4.js";import{a as E}from"./axios.config-D8NC-S8h.js";import{bu as se,aN as te,d as ie,bv as re}from"./api.endpoints-D7eIfK11.js";import{h as L}from"./errorHelper-EbapN-iz.js";import{M as v,T as A}from"./TagInput-D3Dx2LHQ.js";import{D as y,f as ne,c as le}from"./data-TWB-jpMp.js";import{C as B}from"./CAlert-Ceafrkex.js";import{C as j,a as b}from"./CCardBody-DyHbCEEC.js";import{C as _}from"./CCardHeader-BkEnHaV2.js";import{C as z}from"./CButton-ByJ5g7iZ.js";import{C as ce}from"./CForm-BElthXFv.js";import{C as d,a as i}from"./CRow-C5aZ3uce.js";import{C as l}from"./CFormControlWrapper-aXjT4m4y.js";import{C as x}from"./CFormInput-CzlD-ECf.js";import{C as O}from"./CFormSelect-BM6fWH_8.js";import{C}from"./CFormTextarea-3GaLNVd-.js";import"./DefaultLayout-BE9qYLzL.js";import"./index.esm-B7prAHhm.js";import"./cil-user-Ddrdy7PS.js";const qe=()=>{const R=Q(),[M,H]=m.useState([]),[U,$]=m.useState([]),[W,K]=m.useState([]),[f,w]=m.useState(""),[Y,S]=m.useState(!1),J=ee().shape({catalogue_ids:G().of(p().required("Invalid catalogue")).min(1,"At least one catalogue must be selected").required("Catalogue is required"),category_id:p().required("Category is required"),subcategory_id:p().required("Subcategory is required"),name:u().required("Title is required").test("no-whitespace","Title cannot be empty or only spaces",a=>a&&a.trim().length>0),slug:u().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens").max(255,"Slug must be at most 255 characters").test("no-whitespace","Slug cannot contain spaces",a=>!/\s/.test(a)),description:u().required("Description is required").test("no-whitespace","Cannot be only spaces",a=>a&&a.trim().length>0),return_policy:u().required("Return policy is required").test("no-whitespace","Cannot be only spaces",a=>a&&a.trim().length>0),subname:u().required("Subname is required").test("no-whitespace","Cannot be only spaces",a=>a&&a.trim().length>0),brand_id:p().required("Brand is required"),search_keyword:u().required("Search keywords is required").max(255,"Search keywords must be at most 255 characters"),collection_ids:G().optional().nullable(),traditional_categories:u().required("Traditional category is required").test("not-empty","Traditional category cannot be empty or only spaces",a=>!!a&&a.trim().length>0),country_origin:u().required("Country of origin is required"),length:p().typeError("Length must be a number").required("Length is required"),breadth:p().typeError("Breadth must be a number").required("Breadth is required"),height:p().typeError("Height must be a number").required("Height is required"),weight:p().typeError("Weight must be a number").required("Weight is required"),thumbnail_image:F().required("Thumbnail image is required").test("fileType","Only JPG, JPEG, and PNG formats are allowed",a=>a&&["image/jpg","image/jpeg","image/png"].includes(a.type)).test("fileSize","File size must be less than 5MB",function(a){return!a||typeof a!="object"?!0:a.size>12*1024*1024?this.createError({message:"File exceeds 12MB limit"}):!0}),size_chart:F().required("Size chart image is required").test("fileType","Only JPG, JPEG, and PNG formats are allowed",a=>a&&["image/jpg","image/jpeg","image/png"].includes(a.type)).test("fileSize","File size must be less than 5MB",function(a){return!a||typeof a!="object"?!0:a.size>12*1024*1024?this.createError({message:"File exceeds 12MB limit"}):!0})});m.useEffect(()=>{(async()=>{S(!0);try{const[a,r,g]=await Promise.all([E.get(se),E.get(te),E.get(ie)]),{data:n}=a||[];H(n),$(r.data),K(g.data)}catch(a){w(L(a))}finally{S(!1)}})()},[]),m.useEffect(()=>{if(f){const a=setTimeout(()=>{w("")},3e3);return()=>clearTimeout(a)}},[f]);const X=async(a,{resetForm:r})=>{var n;console.log("values",a),S(!0),w("");const g=new FormData;Object.keys(a).forEach(h=>{const s=a[h];if(Array.isArray(s))s.forEach(t=>{g.append(`${h}[]`,t)});else{const t=typeof s=="string"?s.trim():s;g.append(h,t)}}),(n=a.images)!=null&&n.length&&a.images.forEach((h,s)=>{g.append(`image${s+1}`,h)});try{const{status:h}=await E.post(re,g,{headers:{"Content-Type":"multipart/form-data"}});h===201&&R("/products-list")}catch(h){w(L(h))}finally{S(!1)}};return Y?e.jsx(V,{color:"primary",className:"d-block mx-auto my-5"}):f?e.jsx(B,{color:"danger",children:f}):e.jsx(e.Fragment,{children:e.jsxs(j,{children:[e.jsxs(_,{className:"d-flex align-items-center gap-3",children:[e.jsxs(z,{color:"secondary",variant:"outline",className:"d-flex align-items-center gap-2",onClick:()=>R(-1),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Back"]}),e.jsx("strong",{className:"fs-5",children:"NEW PRODUCT LISTING"})]}),e.jsxs(b,{children:[e.jsx(ae,{initialValues:{catalogue_ids:[],category_id:"",subcategory_id:"",item_id:"",name:"",slug:"",fit:"",description:"",return_policy:"",length:"",breadth:"",height:"",weight:"",subname:"",brand_id:"",collection_ids:[],thumbnail_image:"",fabric:[],stretchable:"",key_feature:[],in_the_box:"",search_keyword:"",size_chart:"",care_guide:"",pattern:[],print_type:"",country_origin:"",manufacturing_details:"",traditional_categories:""},validationSchema:J,onSubmit:X,children:({values:a,setFieldValue:r,setTouched:g,handleChange:n,handleSubmit:h,errors:s,touched:t})=>{const[T,Z]=m.useState([]),[I,P]=m.useState([]),[k,q]=m.useState([]);return m.useEffect(()=>{const c=M.filter(o=>{var D;return(D=a.catalogue_ids)==null?void 0:D.includes(o.id)}),N=[...new Map(c.flatMap(o=>o.categories||[]).map(o=>[o.id,o])).values()];Z(N),P([]),q([]),r("category_id",null),r("subcategory_id",null),r("item_id",null),g({category_id:!1,subcategory_id:!1,item_id:!1})},[a.catalogue_ids]),m.useEffect(()=>{const c=T.find(o=>o.id===a.category_id),N=[...new Map(((c==null?void 0:c.subcategories)||[]).map(o=>[o.id,o])).values()];P(N),q([]),r("subcategory_id",null),r("item_id",null),g({subcategory_id:!1,item_id:!1})},[a.category_id]),m.useEffect(()=>{const c=I.find(o=>o.id===a.subcategory_id),N=(c==null?void 0:c.items)||[];q(N),r("item_id",null),g({item_id:!1})},[a.subcategory_id]),e.jsx(e.Fragment,{children:e.jsxs(ce,{onSubmit:h,children:[e.jsxs(j,{children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT IDENTITY"})}),e.jsxs(b,{className:"d-flex flex-column row-gap-2",children:[e.jsxs(d,{children:[e.jsx(i,{md:4,children:e.jsx(v,{label:"Catalogues",name:"catalogue_ids",placeholder:"Select Catalogue",options:M,values:a.catalogue_ids,setFieldValue:r,error:s.catalogue_ids,touched:t.catalogue_ids})}),e.jsx(i,{md:4,children:e.jsx(y,{label:"Category",name:"category_id",placeholder:"fit...",options:T,value:a.category_id,setFieldValue:r,error:s.category_id,touched:t.category_id,disabled:T.length===0})}),e.jsx(i,{md:4,children:e.jsx(y,{label:"Subcategory",name:"subcategory_id",placeholder:"fit...",options:I,value:a.subcategory_id,setFieldValue:r,error:s.subcategory_id,touched:t.subcategory_id,disabled:I.length===0})})]}),e.jsxs(d,{children:[e.jsx(i,{md:4,children:e.jsx(y,{label:"Item",name:"item_id",placeholder:"fit...",options:k,value:a.item_id,setFieldValue:r,error:s.item_id,touched:t.item_id,disabled:k.length===0})}),e.jsx(i,{md:4,children:e.jsx(y,{label:"Brand",name:"brand_id",placeholder:"brands...",options:U,value:a.brand_id,setFieldValue:r,error:s.brand_id,touched:t.brand_id})})]})]})]}),e.jsxs(j,{className:"mt-4",children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT IMAGES"})}),e.jsx(b,{className:"d-flex flex-column row-gap-4",children:e.jsx(d,{children:e.jsxs(i,{md:4,children:[e.jsxs(l,{htmlFor:"thumbnail_image",className:"fw-semibold",children:["THUMBNAIL IMAGE",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Test",type:"file",name:"thumbnail_image",onChange:c=>r("thumbnail_image",c.target.files[0])}),s.thumbnail_image&&t.thumbnail_image&&e.jsx("div",{className:"text-danger small",children:s.thumbnail_image})]})})})]}),e.jsxs(j,{className:"mt-4",children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT SPECIFICATION"})}),e.jsxs(b,{className:"d-flex flex-column row-gap-4",children:[e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"name",className:"fw-semibold",children:["NAME",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Product Name",type:"text",name:"name",value:a.name,onChange:n}),s.name&&t.name&&e.jsx("div",{className:"text-danger small",children:s.name})]}),e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"subname",className:"fw-semibold",children:["SUBNAME",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Sub Name",type:"text",name:"subname",value:a.subname,onChange:n}),s.subname&&t.subname&&e.jsx("div",{className:"text-danger small",children:s.subname})]})]}),e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"slug",className:"fw-semibold",children:["SLUG",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Product Slug",type:"text",name:"slug",value:a.slug,onChange:n}),s.slug&&t.slug&&e.jsx("div",{className:"text-danger small",children:s.slug})]}),e.jsx(i,{md:3,children:e.jsx(y,{label:"Size fit",name:"fit",placeholder:"fit...",options:ne,value:a.fit,setFieldValue:r,error:s.fit,touched:t.fit})}),e.jsx(i,{xs:3,children:e.jsx(A,{label:"Fabric",placeholder:"Type to search...",name:"fabric",values:a.fabric,setFieldValue:r,error:s.fabric,touched:t.fabric})})]}),e.jsxs(d,{children:[e.jsx(i,{xs:6,children:e.jsx(A,{label:"Pattern",placeholder:"Type to search...",name:"pattern",values:a.pattern,setFieldValue:r,error:s.pattern,touched:t.pattern})}),e.jsxs(i,{md:6,children:[e.jsx(l,{htmlFor:"print_type",className:"fw-semibold",children:"PRINT TYPE"}),e.jsx(x,{placeholder:"Print Type",type:"text",name:"print_type",value:a.print_type,onChange:n}),s.print_type&&t.print_type&&e.jsx("div",{className:"text-danger small",children:s.print_type})]})]}),e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsx(l,{htmlFor:"stretchable",className:"fw-semibold",children:"STRETCHABLE"}),e.jsxs(O,{name:"stretchable",value:a.stretchable,onChange:n,children:[e.jsx("option",{value:"",children:"Select Stretchable"}),e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]}),s.stretchable&&t.stretchable&&e.jsx("div",{className:"text-danger small",children:s.stretchable})]}),e.jsx(i,{xs:6,children:e.jsx(A,{label:"Key Features",placeholder:"Type to search...",name:"key_feature",values:a.key_feature,setFieldValue:r,error:s.key_feature,touched:t.key_feature})})]}),e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"size_chart",className:"fw-semibold",children:["SIZE CHART",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{type:"file",name:"size_chart",onChange:c=>r("size_chart",c.target.files[0])}),s.size_chart&&t.size_chart&&e.jsx("div",{className:"text-danger small",children:s.size_chart})]}),e.jsxs(i,{md:6,children:[e.jsx(l,{htmlFor:"in_the_box",className:"fw-semibold",children:"IN THE BOX"}),e.jsx(x,{placeholder:"In the box",type:"text",name:"in_the_box",value:a.in_the_box,onChange:n}),s.in_the_box&&t.in_the_box&&e.jsx("div",{className:"text-danger small",children:s.in_the_box})]})]}),e.jsxs(d,{children:[e.jsxs(i,{xs:6,children:[e.jsxs(l,{htmlFor:"search_keyword",className:"fw-semibold",children:["SEARCH KEYWORDS",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(C,{placeholder:"Search Keyword",type:"text",name:"search_keyword",value:a.search_keyword,onChange:n}),s.search_keyword&&t.search_keyword&&e.jsx("div",{className:"text-danger small",children:s.search_keyword})]}),e.jsxs(i,{md:6,children:[e.jsx(l,{htmlFor:"care_guide",className:"fw-semibold",children:"CARE GUIDE"}),e.jsx(C,{placeholder:"Care Guide",type:"text",name:"care_guide",value:a.care_guide,onChange:n}),s.care_guide&&t.care_guide&&e.jsx("div",{className:"text-danger small",children:s.care_guide})]})]}),e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"description",className:"fw-semibold",children:["DESCRIPTION",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(C,{placeholder:"Description",type:"text",name:"description",value:a.description,onChange:n}),s.description&&t.description&&e.jsx("div",{className:"text-danger small",children:s.description})]}),e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"return_policy",className:"fw-semibold",children:["RETURN POLICY",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(C,{placeholder:"Policy",type:"text",name:"return_policy",value:a.return_policy,onChange:n}),s.return_policy&&t.return_policy&&e.jsx("div",{className:"text-danger small",children:s.return_policy})]})]})]})]}),e.jsxs(j,{className:"mt-4",children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"PACKAGE DETAILS"})}),e.jsxs(b,{className:"d-flex flex-column row-gap-4",children:[e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"length",className:"fw-semibold",children:["LENGTH (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Length",type:"number",name:"length",value:a.length,onChange:n}),s.length&&t.length&&e.jsx("div",{className:"text-danger small",children:s.length})]}),e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"breadth",className:"fw-semibold",children:["BREADTH (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Breadth",type:"number",name:"breadth",value:a.breadth,onChange:n}),s.breadth&&t.breadth&&e.jsx("div",{className:"text-danger small",children:s.breadth})]})]}),e.jsxs(d,{children:[e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"height",className:"fw-semibold",children:["HEIGHT (CM)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Height",type:"number",name:"height",value:a.height,onChange:n}),s.height&&t.height&&e.jsx("div",{className:"text-danger small",children:s.height})]}),e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"weight",className:"fw-semibold",children:["WEIGHT (KG)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(x,{placeholder:"Weight",name:"weight",type:"number",value:a.weight,onChange:n}),s.weight&&t.weight&&e.jsx("div",{className:"text-danger small",children:s.weight})]})]})]})]}),e.jsxs(j,{className:"mt-4",children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"MANUFACTURING DETAILS"})}),e.jsx(b,{children:e.jsxs(d,{children:[e.jsx(i,{md:6,children:e.jsx(y,{label:"Country of Origin",name:"country_origin",placeholder:"country...",options:le,value:a.country_origin,setFieldValue:r,error:s.country_origin,touched:t.country_origin})}),e.jsxs(i,{md:6,children:[e.jsx(l,{htmlFor:"manufacturing_details",className:"fw-semibold",children:"MANUFACTURER DETAILS"}),e.jsx(C,{placeholder:"Manufacturer Details",type:"text",name:"manufacturing_details",value:a.manufacturing_details,onChange:n})]})]})})]}),e.jsxs(j,{className:"mt-4",children:[e.jsx(_,{className:"fs-5",children:e.jsx("strong",{children:"PRODUCT INTEGRATION"})}),e.jsx(b,{children:e.jsxs(d,{className:"mt-3",children:[e.jsx(i,{md:4,children:e.jsx(v,{label:"Collections",name:"collection_ids",placeholder:"Select Collections",options:W.map(c=>({id:c.id,name:c.title})),values:a.collection_ids,setFieldValue:r,error:s.collection_ids,touched:t.collection_ids})}),e.jsxs(i,{md:6,children:[e.jsxs(l,{htmlFor:"traditional_categories",className:"fw-semibold",children:["TRADITIONAL CATEGORIES",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(O,{name:"traditional_categories",value:a.traditional_categories,onChange:n,children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"tam",children:"Traditional Marathi (TAM)"}),e.jsx("option",{value:"lam",children:"Look a like Marathi (LAM)"}),e.jsx("option",{value:"rim",children:"Re-Imagined Marathi (RIM)"})]}),s.traditional_categories&&t.traditional_categories&&e.jsx("div",{className:"text-danger small",children:s.traditional_categories})]})]})})]}),e.jsx(z,{color:"success",type:"submit",className:"mt-3",children:"Add Product"})]})})}}),f&&e.jsx(B,{color:"danger",children:f})]})]})})};export{qe as default};
