import{a,j as e,C as O}from"./index-f6D6TMGS.js";import{a as p}from"./axios.config-D8NC-S8h.js";import{ar as q,as as G,at as J}from"./api.endpoints-D7eIfK11.js";import{u as C,w as K,F as P}from"./FileSaver.min-_VtqP_qQ.js";import{M as S}from"./Modal-Byr5KNe-.js";import{h as j}from"./errorHelper-EbapN-iz.js";import{C as Q,a as V}from"./CRow-C5aZ3uce.js";import{C as W,a as X}from"./CCardBody-DyHbCEEC.js";import{C as Y}from"./CCardHeader-BkEnHaV2.js";import{C as g}from"./CButton-ByJ5g7iZ.js";import{C as Z,a as ee,b as D,c as n,d as te,e as r}from"./CTable-Bj0B-88c.js";import{C as se}from"./CAlert-Ceafrkex.js";import"./CModalHeader-fVen3JA5.js";import"./DefaultLayout-BE9qYLzL.js";import"./index.esm-B7prAHhm.js";import"./cil-user-Ddrdy7PS.js";import"./CModalTitle-AQ6XSAyd.js";const ye=()=>{const[l,_]=a.useState([]),[y,M]=a.useState(""),[E,u]=a.useState(!1),[T,x]=a.useState(!1),[b,k]=a.useState(null),[w,i]=a.useState(""),[B,o]=a.useState(!1),[s,h]=a.useState([]);a.useEffect(()=>{f()},[]),a.useEffect(()=>{if(y||w){const t=setTimeout(()=>{M(""),i("")},3e3);return()=>clearTimeout(t)}},[y,w]);const f=async()=>{o(!0),i("");try{const{data:t}=await p.get(q);_(t)}catch(t){i(j(t))}finally{o(!1)}},I=t=>{k(t),u(!0)},A=async()=>{if(b){o(!0);try{await p.delete(`${G}/${b}`),f()}catch(t){i(j(t))}finally{u(!1),k(null),o(!1)}}},N=()=>{s.length>0&&x(!0)},v=async()=>{if(s.length!==0){o(!0);try{await p.post(`${J}`,{ids:s}),h([]),f()}catch(t){i(j(t))}finally{x(!1),o(!1)}}},$=t=>{h(c=>c.includes(t)?c.filter(m=>m!==t):[...c,t])},H=t=>s.includes(t),L=()=>{s.length===l.length?h([]):h(l.map(t=>t.id))},R=()=>{const t=l.filter(d=>s.includes(d.id)).map((d,z)=>({Index:z+1,Name:d.name,Email:d.email,Message:d.message})),c=C.json_to_sheet(t),m=C.book_new();C.book_append_sheet(m,c,"Contact Messages");const F=K(m,{bookType:"xlsx",type:"array"}),U=new Blob([F],{type:"application/octet-stream"});P.saveAs(U,"contact_messages.xlsx")};return B?e.jsx(O,{color:"primary",className:"d-block mx-auto my-5"}):e.jsxs(Q,{children:[e.jsx(V,{xs:12,children:e.jsxs(W,{children:[e.jsx(Y,{children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:5},children:e.jsx("strong",{children:"Contact Us"})}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx(g,{color:"success",className:"text-white fw-normal",onClick:R,disabled:s.length===0,children:"Export Selected"}),e.jsx(g,{color:"danger",className:"text-white fw-normal",onClick:N,disabled:s.length===0,children:"Bulk Delete"})]})]})}),e.jsx(X,{children:l.length>0?e.jsxs(Z,{hover:!0,children:[e.jsx(ee,{children:e.jsxs(D,{children:[e.jsx(n,{scope:"col",children:e.jsx("input",{type:"checkbox",checked:s.length===l.length,onChange:L})}),e.jsx(n,{width:100,children:"Name"}),e.jsx(n,{children:"Email"}),e.jsx(n,{width:150,children:"Date & Time"}),e.jsx(n,{children:"Message"}),e.jsx(n,{children:"Action"})]})}),e.jsx(te,{children:l.map(t=>e.jsxs(D,{children:[e.jsx(r,{children:e.jsx("input",{type:"checkbox",checked:H(t.id),onChange:()=>$(t.id)})}),e.jsx(r,{children:t.name}),e.jsx(r,{children:t.email}),e.jsx(r,{children:new Date(t.created_at).toLocaleString("en-IN",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),e.jsx(r,{children:t.message}),e.jsx(r,{children:e.jsx(g,{color:"danger",size:"sm",onClick:()=>I(t.id),children:"Delete"})})]},t.id))})]}):e.jsx(se,{color:"info",children:"No messages found."})})]})}),e.jsx(S,{visible:E,onClose:()=>u(!1),onConfirm:A,title:"Confirm Delete",message:"Are you sure you want to delete this contact message?"}),e.jsx(S,{visible:T,onClose:()=>x(!1),onConfirm:v,title:"Confirm Bulk Delete",message:`Are you sure you want to delete ${s.length} selected contact message(s)?`})]})};export{ye as default};
